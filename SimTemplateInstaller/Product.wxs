<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <!--
   Upgrade code HAS to be the same for all updates. Once you've chosen it don't change it.
   Product IDs must be autogenerated (*) or else major upgrades will not work -->
  <Product Id="*" Name="SimTemplate" Language="1033" Version="1.0.0.0" Manufacturer="SimPrints"
           UpgradeCode="94180c61-b350-4f94-95da-da58d0c145bb">
    <Package Id="*" Keywords="Installer"
             InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />
    
    <!-- Other installer settings -->
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <MediaTemplate EmbedCab="yes"/>

    <!-- Tell WiX to install the files defined in the ProductCompenents fragment -->
    <Feature Id="ProductFeature" Title="SimTemplateInstaller" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
    </Feature>
    
    <!-- Tell WiX to show the specified licence file while installing -->
    <UIRef Id="WixUI_InstallDir" />
    <WixVariable Id="WixUILicenseRtf" Value="$(var.ProjectDir)GPL_v3.txt" />
  </Product>

  <!-- Define the directory structure -->
  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="SimTemplateInstaller">
          <Directory Id="dirF7618158CE8FEC39DAC1DD18D359DD11" Name="de"/>
          <Directory Id="dir9901A63403F617629D713CCDD5F76555" Name="en"/>
          <Directory Id="dir63A634F9A8BE5EC5B8B7424D6A18E4C4" Name="es"/>
          <Directory Id="dir1424604976AE3158AC7908CE5FE4118E" Name="fr"/>
          <Directory Id="dirFCEE6B4345A27586A07C0608D2A46020" Name="it"/>
          <Directory Id="dir4BAF3ACC1308889E29E86346A3C9852C" Name="ja"/>
          <Directory Id="dir3F45E3C3D1C6EF4E90C4421900E566D7" Name="ko"/>
          <Directory Id="dir0DF44C6AAA034D1DA7FB5C126F730566" Name="ru"/>
          <Directory Id="dir827E768E8FAD19EE7610193A7741CC10" Name="zh-Hans"/>
          <Directory Id="dir60793078BF73FA4CCBF305630D99D730" Name="zh-Hant"/>
        </Directory>
      </Directory>
    </Directory>
  </Fragment>

  <!-- The files in the installer package -->
  <Fragment>
    <ComponentGroup Id="ProductComponents">
      <Component Id="cmpACB6CD6FFB2A84501BD9E8392459FA45" Guid="*" Directory="INSTALLFOLDER">
        <File Id="fil53CF67BC1F7314B08C1D64A6CEA223E4" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)log4net.dll" />
      </Component>
      <Component Id="cmp971CAA5089C607CB15ABC6DB8CA7C5C2" Guid="*" Directory="INSTALLFOLDER">
        <File Id="filC2B8A215F89AF1071ADDFC39EAE7D41E" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)log4net.xml" />
      </Component>
      <Component Id="cmp6420500FF1ABC06969E348ACB0B55D77" Guid="*" Directory="INSTALLFOLDER">
        <File Id="filA545F6C5C51315B4671A7FE6553F80CE" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)System.Windows.Interactivity.dll" />
      </Component>
      <Component Id="cmp204E80352F2117A89B8FAA7285B7AE1E" Guid="*" Directory="INSTALLFOLDER">
        <File Id="fil4A8BCB51ABD92E0305B1E743AAE5D041" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)SimTemplate.exe" />
      </Component>
      <Component Id="cmp1F6FB723A87E74F9C6201CA042E68FC0" Guid="*" Directory="INSTALLFOLDER">
        <File Id="filC068BFE2C687F70CA970742F352A4CA2" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)SimTemplate.exe.config" />
      </Component>
      <Component Id="cmpFA4C7031708BD72E7F060223F054F84E" Guid="*" Directory="INSTALLFOLDER">
        <File Id="filCED0B21B533C69056C91A935B9EF5767" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)SimTemplate.pdb" />
      </Component>
      <Component Id="cmpC818AA58898C1918C6CEC1A3D7259DC6" Guid="*" Directory="dirF7618158CE8FEC39DAC1DD18D359DD11">
        <File Id="fil58584193ABDE2610880AE18F442659FA" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)de\System.Windows.Interactivity.resources.dll" />
      </Component>
      <Component Id="cmp74ECD645D51366788BE4C927018786EF" Guid="*" Directory="dir9901A63403F617629D713CCDD5F76555">
        <File Id="fil08F7F524BE285D997DB5BC5DEAEAE82E" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)en\System.Windows.Interactivity.resources.dll" />
      </Component>
      <Component Id="cmp9F7B14463AE1AB942ED83DC374A7F052" Guid="*" Directory="dir63A634F9A8BE5EC5B8B7424D6A18E4C4">
        <File Id="filA44307B73B0874F5648488CEEC6AD5DB" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)es\System.Windows.Interactivity.resources.dll" />
      </Component>
      <Component Id="cmpAE8F265E06B7B311BA09E444833B59B7" Guid="*" Directory="dir1424604976AE3158AC7908CE5FE4118E">
        <File Id="fil6D4BDC0B69882FB9B370F0BC70362E56" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)fr\System.Windows.Interactivity.resources.dll" />
      </Component>
      <Component Id="cmpA90B42440CCB0E677927B96F0A0B1082" Guid="*" Directory="dirFCEE6B4345A27586A07C0608D2A46020">
        <File Id="fil8D851F839EBD028A49BF550BD6B1B377" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)it\System.Windows.Interactivity.resources.dll" />
      </Component>
      <Component Id="cmpEDA216DA3A5B8885E3390522FC0BF03B" Guid="*" Directory="dir4BAF3ACC1308889E29E86346A3C9852C">
        <File Id="fil166F06427CB5521C1A5024FE28D9847E" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)ja\System.Windows.Interactivity.resources.dll" />
      </Component>
      <Component Id="cmp48FA0C77FEA5A38E70E72279C618C798" Guid="*" Directory="dir3F45E3C3D1C6EF4E90C4421900E566D7">
        <File Id="fil490F0A70453C36335B51EAC27C15407B" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)ko\System.Windows.Interactivity.resources.dll" />
      </Component>
      <Component Id="cmp20AEE4316235BBBBF4375F6CB7F99436" Guid="*" Directory="dir0DF44C6AAA034D1DA7FB5C126F730566">
        <File Id="fil415FE918C5919F0A899821C6CFBC6737" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)ru\System.Windows.Interactivity.resources.dll" />
      </Component>
      <Component Id="cmp4A47D8C94FF54E69DAFEF5D6856E5A49" Guid="*" Directory="dir827E768E8FAD19EE7610193A7741CC10">
        <File Id="filFA6D826059DD9522CE8DF3B4D8CA39FA" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)zh-Hans\System.Windows.Interactivity.resources.dll" />
      </Component>
      <Component Id="cmpBAF73E714FD4FBBF32ADE412B12AC057" Guid="*" Directory="dir60793078BF73FA4CCBF305630D99D730">
        <File Id="fil3BD84D5400094407052B27167EA0D94A" KeyPath="yes" Source="$(var.SimTemplate.TargetDir)zh-Hant\System.Windows.Interactivity.resources.dll" />
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>